version: "3.9"

services:

  # â”€â”€ BTP-Nexus API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  btp-nexus-api:
    build: .
    container_name: btp-nexus-api
    ports:
      - "8000:8000"

    # ðŸ”¥ Mount project directory for live code updates
    volumes:
      - .:/app

    environment:
      - GROQ_API_KEY=${GROQ_API_KEY}
      - NEO4J_URI=bolt://neo4j:7687
      - NEO4J_USER=neo4j
      - NEO4J_PASSWORD=password
      - MLFLOW_TRACKING_URI=http://mlflow:5000

    depends_on:
      - neo4j
      - mlflow

    restart: unless-stopped


  # â”€â”€ Neo4j Knowledge Graph â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  neo4j:
    image: neo4j:5
    container_name: btp-nexus-neo4j
    ports:
      - "7474:7474"
      - "7687:7687"
    environment:
      - NEO4J_AUTH=neo4j/password
    volumes:
      - neo4j_data:/data
    restart: unless-stopped


  # â”€â”€ MLflow Tracking Server â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  mlflow:
    image: ghcr.io/mlflow/mlflow:v2.13.0
    container_name: btp-nexus-mlflow
    ports:
      - "5000:5000"
    command: mlflow server --host 0.0.0.0 --port 5000
    volumes:
      - mlflow_data:/mlflow
    restart: unless-stopped


volumes:
  neo4j_data:
  mlflow_data: